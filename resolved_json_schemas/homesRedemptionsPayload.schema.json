{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://ira-rebates.labworks.org/schemas/homesRedemption",
  "type": "object",
  "properties": {
    "rebate_type": {
      "title": "Rebate type",
      "enum": [
        "MEASURED",
        "MODELED"
      ],
      "description": "The HOMES rebates have two distinct options for determining savings and rebate amounts, MODELED vs MEASURED."
    },
    "rebate_deducted": {
      "type": "number",
      "minimum": 0,
      "title": "Rebate deducted",
      "description": "This is the amount that was deducted from the customer's/homeowner's purchase price or invoiced amount for products and/or installation."
    },
    "equipment_and_material_cost": {
      "type": "integer",
      "title": "Equipment and material cost",
      "minimum": 0,
      "description": "The total cost of the equipment and materials used."
    },
    "installation_cost": {
      "type": "integer",
      "minimum": 0,
      "title": "Installation cost",
      "description": "This is the delivery and installation costs associated with this redemption. To qualify, the installation must be performed by an approved installer. This field should be included in any redemption that includes an installation cost. It *must* appear in at least one redemption associated with this reservation unless *is_do_it_yourself* is *true*. If there is no installation cost associated with the redemption, then this field should be omitted."
    },
    "project_completion_date": {
      "type": "string",
      "format": "date",
      "title": "Project completion date",
      "description": "This is the date at which the project was completed. This field is required when *redemption_type* is COMPLETION."
    },
    "measured_post_retrofit_energy_usage_kwh_equivalent": {
      "type": "integer",
      "title": "Measured post retrofit energy usage kwh equivalent",
      "minimum": 0,
      "description": "The total actual annual energy usage converted to kWh-equivalent for the home or multifamily building post-retrofit - based on normalized utility bill data. This is field is used for MEASURED redemptions only."
    }
  },
  "required": [
    "rebate_deducted",
    "equipment_and_material_cost",
    "installation_cost",
    "project_completion_date"
  ],
  "if": {
    "properties": {
      "rebate_type": {
        "const": "MEASURED"
      }
    },
    "required": [
      "rebate_type"
    ]
  },
  "then": {
    "required": [
      "measured_post_retrofit_energy_usage_kwh_equivalent"
    ]
  },
  "else": {
    "not": {
      "required": [
        "measured_post_retrofit_energy_usage_kwh_equivalent"
      ]
    }
  },
  "additionalProperties": false
}